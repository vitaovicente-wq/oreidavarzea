<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRFutebol - Classificação</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <script src="engine-core.js"></script>

    <style>
        :root { 
            --bg-dark: #121212; 
            --panel-bg: #1e1e24;
            --border: #2d2d35;
            --accent: #00ff88;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            
            /* Cores de Zona */
            --liberta: #2ecc71;
            --pre-liberta: #3498db;
            --sula: #f1c40f;
            --z4: #e74c3c;
        }
        
        * { box-sizing: border-box; }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-dark); 
            color: var(--text-primary); 
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            height: 100vh; 
            overflow: hidden;
        }
        
        /* HEADER */
        .header { 
            height: 70px; 
            background: #16161a; 
            border-bottom: 1px solid var(--border); 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 0 25px; 
            flex-shrink: 0;
        }
        .app-brand { font-family: 'Rajdhani'; font-weight: 700; font-size: 1.5rem; letter-spacing: 1px; }
        .app-brand span { color: var(--accent); }
        
        .btn-back { 
            background: transparent; border: 1px solid var(--border); 
            color: var(--text-secondary); padding: 8px 16px; border-radius: 4px; 
            text-decoration: none; font-size: 0.85rem; transition: 0.2s; 
        }
        .btn-back:hover { border-color: var(--accent); color: var(--accent); }

        /* CONTEÚDO PRINCIPAL */
        .main-content { 
            flex: 1; 
            padding: 20px; 
            overflow-y: auto; 
            display: flex; 
            justify-content: center;
        }

        .table-container {
            width: 100%;
            max-width: 1000px;
            background: var(--panel-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* TABELA */
        table { width: 100%; border-collapse: collapse; text-align: center; }
        
        thead { background: #111; border-bottom: 2px solid var(--border); }
        th { 
            padding: 15px 10px; 
            font-size: 0.8rem; 
            color: var(--text-secondary); 
            text-transform: uppercase; 
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        /* Coluna Clube alinhada a esquerda */
        th:nth-child(2), td:nth-child(2) { text-align: left; }

        td { padding: 12px 10px; border-bottom: 1px solid var(--border); font-size: 0.95rem; }
        tr:last-child td { border-bottom: none; }

        /* Destaques de Coluna */
        .col-pts { font-weight: 700; color: #fff; background: rgba(255,255,255,0.03); }
        .col-sg { color: var(--text-secondary); font-size: 0.85rem; }

        /* Linhas Especiais */
        tr.meu-time { background: rgba(0, 255, 136, 0.15) !important; border-left: 4px solid var(--accent); }
        
        /* Indicadores de Zona (Bolinha colorida) */
        .zone-indicator {
            width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 8px;
        }

        /* LEGENDA */
        .legenda {
            padding: 15px;
            background: #111;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 20px;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .legenda-item { display: flex; align-items: center; gap: 5px; }
        .dot { width: 10px; height: 10px; border-radius: 2px; }

        /* RESPONSIVO */
        @media (max-width: 768px) {
            .hide-mobile { display: none; }
            th, td { padding: 10px 5px; font-size: 0.85rem; }
            .col-club { max-width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="app-brand">BR<span>FUTEBOL</span></div>
        <a href="dashboard.html" class="btn-back">← Voltar</a>
    </header>

    <div class="main-content">
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th width="50">Pos</th>
                        <th>Clube</th>
                        <th width="50" title="Pontos">PTS</th>
                        <th width="40" title="Jogos">J</th>
                        <th width="40" title="Vitórias">V</th>
                        <th width="40" title="Empates">E</th>
                        <th width="40" title="Derrotas">D</th>
                        <th width="40" class="hide-mobile" title="Gols Pró">GP</th>
                        <th width="40" class="hide-mobile" title="Gols Contra">GC</th>
                        <th width="40" title="Saldo de Gols">SG</th>
                        <th width="50" class="hide-mobile" title="Aproveitamento">%</th>
                    </tr>
                </thead>
                <tbody id="tabela-corpo">
                    </tbody>
            </table>

            <div class="legenda">
                <div class="legenda-item"><div class="dot" style="background:var(--liberta)"></div> Libertadores</div>
                <div class="legenda-item"><div class="dot" style="background:var(--pre-liberta)"></div> Pré-Liberta</div>
                <div class="legenda-item"><div class="dot" style="background:var(--sula)"></div> Sul-Americana</div>
                <div class="legenda-item"><div class="dot" style="background:var(--z4)"></div> Rebaixamento</div>
            </div>
        </div>
    </div>

    <script>
        window.onload = function() {
            if (typeof Engine === 'undefined') {
                alert("Erro: Engine não carregada.");
                return;
            }
            renderizarClassificacao();
        };

        function renderizarClassificacao() {
            const game = Engine.carregarJogo();
            if(!game) { window.location.href = 'index.html'; return; }

            // Pega a tabela e garante ordenação correta
            // Critérios: Pontos > Vitórias > Saldo > Gols Pró
            let tabela = game.classificacao.sort((a, b) => {
                if (b.pts !== a.pts) return b.pts - a.pts;
                if (b.v !== a.v) return b.v - a.v;
                if (b.sg !== a.sg) return b.sg - a.sg;
                return b.gp - a.gp;
            });

            const tbody = document.getElementById('tabela-corpo');
            tbody.innerHTML = "";

            tabela.forEach((time, index) => {
                const pos = index + 1;
                const tr = document.createElement('tr');
                
                // Verifica se é o time do jogador
                if (time.nome === game.info.time) {
                    tr.classList.add('meu-time');
                }

                // Lógica de Cores da Zona (Série A Padrão)
                let zoneColor = "transparent";
                if (pos <= 4) zoneColor = "var(--liberta)";
                else if (pos <= 6) zoneColor = "var(--pre-liberta)";
                else if (pos <= 12) zoneColor = "var(--sula)";
                else if (pos >= 17) zoneColor = "var(--z4)";

                // Cálculo de Aproveitamento
                const aproveitamento = time.j > 0 ? Math.round((time.pts / (time.j * 3)) * 100) : 0;

                // Escudo Fallback
                const escudoUrl = time.escudo || "https://cdn-icons-png.flaticon.com/512/53/53283.png";

                tr.innerHTML = `
                    <td style="font-weight:700; border-left: 4px solid ${zoneColor};">${pos}º</td>
                    <td class="col-club" style="display:flex; align-items:center; gap:10px;">
                        <img src="${escudoUrl}" width="24" height="24" onerror="this.src='https://cdn-icons-png.flaticon.com/512/53/53283.png'">
                        <span style="font-weight:600; color:#fff;">${time.nome}</span>
                    </td>
                    <td class="col-pts">${time.pts}</td>
                    <td style="color:#fff;">${time.j}</td>
                    <td style="color:#ccc;">${time.v}</td>
                    <td style="color:#ccc;">${time.e}</td>
                    <td style="color:#ccc;">${time.d}</td>
                    <td class="hide-mobile" style="color:#888;">${time.gp}</td>
                    <td class="hide-mobile" style="color:#888;">${time.gc}</td>
                    <td class="col-sg">${time.sg}</td>
                    <td class="hide-mobile" style="font-size:0.8rem; color:#666;">${aproveitamento}%</td>
                `;

                tbody.appendChild(tr);
            });
        }
    </script>
</body>
</html>
