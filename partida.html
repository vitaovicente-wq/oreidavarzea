<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>O Rei da V√°rzea ‚Äî Partida</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap');
  :root{font-family:'Roboto Condensed', system-ui, -apple-system, Segoe UI, Roboto, Arial;}
  body{margin:0;background:#f5f7fb;color:#111}
  header{background:#0b6bd6;color:#fff;padding:14px 18px}
  .container{max-width:1100px;margin:18px auto;padding:10px}
  .card{background:#fff;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);padding:16px;margin-bottom:16px;}
  button{background:#0b6bd6;color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer; transition: all 0.2s ease-in-out; box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
  button:hover:not(:disabled){opacity:0.9; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15);}
  button[disabled]{opacity:0.45;cursor:not-allowed; background-color: #6c757d;}
  .muted{color:#666;font-size:13px}
  .notif{position:fixed;top:18px;right:18px;background:#ffefc2;color:#333;padding:10px 14px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.12);border:1px solid #e6b800}
  a { text-decoration: none; }
  ul { list-style-type: none; padding-left: 0; }
  li { display: flex; justify-content: space-between; align-items: center; padding: 4px; border-bottom: 1px solid #f0f0f0; font-size: 14px; }
  h4 { color: #666; font-size: 0.8em; text-transform: uppercase; border-bottom: 1px solid #eee; padding-bottom: 5px; margin-top: 20px;}
  .player-events { font-size: 12px; margin-left: 5px;}
  .bench{display:flex;flex-direction:column;gap:6px;max-height:160px;overflow:auto;padding:8px;border:1px dashed #ccc;border-radius:8px}
  .player-card{padding:8px;border-radius:8px;background:#fff;border:1px solid #eee;margin-bottom:6px;display:flex;justify-content:space-between;align-items:center}
  .player-card-info { display: flex; align-items: center; gap: 8px; }
  .status-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
  .status-green { background-color: #28a745; }
  .status-yellow { background-color: #ffc107; }
  .spec-tag { background-color: #e9ecef; color: #495057; font-size: 10px; padding: 2px 6px; border-radius: 10px; }
  .health-bar, .skill-bar { width: 60px; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; display: inline-block; }
  .health-fill { height: 100%; background: #28a745; }
  .skill-fill { height: 100%; background: #9c27b0; }
  .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); }
  .modal-content { background-color: #fff; margin: 10% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 700px; }
  .sub-container { display: flex; gap: 20px; margin-top: 15px; }
  .sub-column { flex: 1; border: 1px solid #ddd; border-radius: 8px; padding: 10px; height: 300px; overflow-y: auto; }
  .sub-player-item { padding: 8px; border-radius: 6px; cursor: pointer; margin-bottom: 5px; border: 1px solid #eee; }
  .sub-player-item:hover { background-color: #f0f8ff; }
  .sub-player-item.selected { background-color: #ffc107; color: #000; border-color: #e0a800; }
  .sub-player-item.disabled { background-color: #e9ecef; color: #6c757d; cursor: not-allowed; opacity: 0.6; }
  .scoreboard-container { padding: 10px; border-radius: 12px; background: #e9ecef; margin-bottom: 15px; }
  .scoreboard { background-color: #222; color: #fff; padding: 10px; border-radius: 10px; display: flex; justify-content: space-around; align-items: center; border: 2px solid #444; box-shadow: inset 0 0 10px rgba(0,0,0,0.5); }
  .scoreboard-team { font-size: 1.2em; font-weight: bold; text-transform: uppercase; flex: 1; text-align: center; }
  .scoreboard-score { font-size: 2.8em; font-weight: bold; font-family: 'Courier New', Courier, monospace; padding: 0 20px; }
  #comentarios p { margin: 8px 0; padding-left: 5px; border-left: 3px solid transparent; }
  #comentarios p.gol { font-weight: bold; color: #1a7431; border-left-color: #28a745; }
  #comentarios p.evento { font-style: italic; color: #555; border-left-color: #ccc; }
  #comentarios p.cartao { color: #856404; font-weight: bold; border-left-color: #ffc107;}
  .match-details { font-size: 14px; text-align: left; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-top: -10px; margin-bottom: 15px; }
  .match-details p { margin: 5px 0; }
  .match-details hr { border: 0; border-top: 1px solid #ccc; margin: 10px 0;}
  .match-details span { font-weight: normal; color: #333; }
</style>
</head>
<body>
<header>
  <div class="container"><h1 id="headerTitle">O Rei da V√°rzea</h1></div>
</header>
<div class="container">
  <div id="tela4" class="card">
    <h2>Partida em andamento</h2>
    <div style="display:flex;gap:16px; align-items: flex-start;">
      <div style="flex:1; text-align: center;">
        <h3 id="leftTeamName">Mandante</h3>
        <h4>Titulares</h4>
        <ul id="leftTeamStarters"></ul>
        <h4>Reservas</h4>
        <div id="leftTeamBench" class="bench"></div>
      </div>
      <div style="flex:2;text-align:center">
        <div class="scoreboard-container">
            <div class="scoreboard">
                <div id="homeTeamName" class="scoreboard-team">MANDANTE</div>
                <div id="score" class="scoreboard-score">0 x 0</div>
                <div id="awayTeamName" class="scoreboard-team">VISITANTE</div>
            </div>
        </div>
        <div id="matchDetails" class="match-details">
          <p><strong>Local:</strong> <span id="matchLocation">--</span></p>
          <p><strong>Campeonato:</strong> <span id="matchChampionship">--</span></p>
          <hr>
          <p><strong>P√∫blico:</strong> <span id="matchAudience">--</span></p>
          <p><strong>Renda (Ingressos):</strong> <span id="matchTicketRevenue">--</span></p>
          <hr>
          <p><strong>RENDA TOTAL DA PARTIDA:</strong> <strong id="matchTotalRevenue" style="color: green;">--</strong></p>
        </div>
        <button id="btnSubstituicao" style="margin-bottom: 10px;">Fazer Substitui√ß√£o (3)</button>
        <div id="comentarios" style="text-align:left;height:300px;overflow-y:auto;border:1px solid #ddd;border-radius:6px;padding:10px; margin-bottom: 10px;"></div>
        <a id="linkVoltar" href="temporada.html">
            <button id="btnContinuar" style="display:none;">Ver Resumo da Rodada</button>
        </a>
      </div>
      <div style="flex:1; text-align: center;">
        <h3 id="rightTeamName">Visitante</h3>
        <h4>Titulares</h4>
        <ul id="rightTeamStarters"></ul>
        <h4>Reservas</h4>
        <div id="rightTeamBench" class="bench"></div>
      </div>
    </div>
  </div>
</div>
<div id="substitutionModal" class="modal">
  <div class="modal-content">
    <h2 id="substitutionModalTitle">Intervalo - Fa√ßa suas substitui√ß√µes</h2>
    <p>Selecione um jogador em campo e um no banco para trocar. <strong id="subsCount">Substitui√ß√µes: 0/5</strong></p>
    <div class="sub-container">
      <div class="sub-column">
        <h3>Em Campo</h3>
        <div id="subPitchPlayers"></div>
      </div>
      <div class="sub-column">
        <h3>No Banco</h3>
        <div id="subBenchPlayers"></div>
      </div>
    </div>
    <button id="btnConfirmSubs" style="margin-top: 20px;">Iniciar 2¬∫ Tempo</button>
  </div>
</div>
<script>
// ========== ESTADO DO JOGO ==========
let hired = []; let userData = {}; let lineup = {}; let varzeaUniverse = []; let currentMatchInfo = {};
let homeTeam = {}; let awayTeam = {}; let userIsHome = false;
let minuto = 1; let gameInterval = null; let currentHalf = 1;
let halftimeStoppage = 0; let fulltimeStoppage = 0;
let subsMade = 0; const MAX_SUBS = 5; let subWindows = 3;
let selectedPlayerOutId = null; let matchRevenue = 0;

const elements = {
  headerTitle: document.getElementById('headerTitle'),
  leftTeamName: document.getElementById('leftTeamName'),
  leftTeamStarters: document.getElementById('leftTeamStarters'),
  leftTeamBench: document.getElementById('leftTeamBench'),
  rightTeamName: document.getElementById('rightTeamName'),
  rightTeamStarters: document.getElementById('rightTeamStarters'),
  rightTeamBench: document.getElementById('rightTeamBench'),
  homeTeamName: document.getElementById('homeTeamName'),
  awayTeamName: document.getElementById('awayTeamName'),
  scoreDisplay: document.getElementById('score'),
  comentarios: document.getElementById('comentarios'),
  btnContinuar: document.getElementById('btnContinuar'),
  btnSubstituicao: document.getElementById('btnSubstituicao'),
  substitutionModal: document.getElementById('substitutionModal'),
  substitutionModalTitle: document.getElementById('substitutionModalTitle'),
  subsCount: document.getElementById('subsCount'),
  subPitchPlayers: document.getElementById('subPitchPlayers'),
  subBenchPlayers: document.getElementById('subBenchPlayers'),
  btnConfirmSubs: document.getElementById('btnConfirmSubs'),
  matchLocation: document.getElementById('matchLocation'),
  matchChampionship: document.getElementById('matchChampionship'),
  matchAudience: document.getElementById('matchAudience'),
  matchTicketRevenue: document.getElementById('matchTicketRevenue'),
  matchTotalRevenue: document.getElementById('matchTotalRevenue'),
};

function showNotif(text, time = 3000) { const box = document.createElement('div'); box.className = 'notif'; box.textContent = text; document.body.appendChild(box); setTimeout(() => box.remove(), time); }
function formatReal(n) { return 'R$ ' + n.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }); }
const addComentario = (min, texto, tipo = 'normal') => { const p = document.createElement('p'); p.innerHTML = `<strong>${min}'</strong> - ${texto}`; if (tipo === 'gol') p.classList.add('gol'); if (tipo === 'evento') p.classList.add('evento'); if (tipo === 'cartao') p.classList.add('cartao'); elements.comentarios.appendChild(p); elements.comentarios.scrollTop = elements.comentarios.scrollHeight; };

function saveMatchState() { /* ... (c√≥digo da fun√ß√£o de salvar) ... */ }
function calculateMatchRevenue() { /* ... (c√≥digo da fun√ß√£o de calcular renda) ... */ }
function gameTick() { /* ... (c√≥digo da simula√ß√£o) ... */ }
function pauseGame() { clearInterval(gameInterval); gameInterval = null; }
function resumeGame() { if (!gameInterval) { gameInterval = setInterval(gameTick, 800); } }
function endGame() { /* ... (c√≥digo de fim de jogo) ... */ }
function generateZapMessages(golsCasa, golsVisitante){ /* ... (c√≥digo do zap) ... */ }
function pickPlayerForEvent(positions, team) { /* ... (c√≥digo de escolher jogador) ... */ }
function addEventIcon(playerIdentifier, icon, team) { /* ... (c√≥digo de adicionar √≠cone) ... */ }
function openSubstitutionModal(isMidGame) { /* ... (c√≥digo do modal) ... */ }
function updateSubstitutionModal() { /* ... (c√≥digo do modal) ... */ }
function handleSubPlayerClick(playerId, isTitular) { /* ... (c√≥digo do modal) ... */ }
function performSubstitution(playerOutId, playerInId) { /* ... (c√≥digo do modal) ... */ }

function populateTeamColumn(side, team, isUser) {
    const nameEl = (side === 'left') ? elements.leftTeamName : elements.rightTeamName;
    const startersEl = (side === 'left') ? elements.leftTeamStarters : elements.rightTeamStarters;
    const benchEl = (side === 'left') ? elements.leftTeamBench : elements.rightTeamBench;

    nameEl.textContent = team.name;
    startersEl.innerHTML = '';
    benchEl.innerHTML = '';

    const squad = isUser ? hired : team.squad;
    const starters = isUser ? squad.filter(p => Object.values(lineup).includes(p.id)) : squad.slice(0, 11);
    const subs = isUser ? squad.filter(p => !Object.values(lineup).includes(p.id)) : squad.slice(11);

    starters.forEach(p => {
        const li = document.createElement('li');
        if (isUser) {
            li.dataset.playerId = p.id;
        } else {
            li.dataset.playerName = p.name;
        }
        li.innerHTML = `<span>${p.name} (${p.pos})</span><span class="player-events"></span>`;
        startersEl.appendChild(li);
    });

    subs.forEach(p => {
        const card = document.createElement('div');
        card.className = 'player-card';
        if(isUser){
            const statusColor = p.health > 75 ? 'green' : 'yellow';
            card.innerHTML = `<div class="player-card-info"><span class="status-dot status-${statusColor}"></span><div><div><strong>${p.name}</strong> <span class="spec-tag">${p.specialization}</span></div><div class="muted">${p.pos} ‚Ä¢ Sa√∫de: ${p.health}%</div></div></div>`;
        } else {
            card.innerHTML = `<div class="player-card-info"><div><strong>${p.name}</strong><div class="muted">${p.pos}</div></div></div>`;
        }
        benchEl.appendChild(card);
    });
}

function init() {
    // Carrega todos os dados
    hired = JSON.parse(localStorage.getItem('elencoDoTime')) || [];
    userData = JSON.parse(localStorage.getItem('userData')) || {};
    lineup = JSON.parse(localStorage.getItem('escalacaoFinal')) || {};
    varzeaUniverse = JSON.parse(localStorage.getItem('varzeaUniverse')) || [];
    currentMatchInfo = JSON.parse(localStorage.getItem('currentMatchInfo')) || {};

    if (!currentMatchInfo.homeTeam) {
        alert("Informa√ß√µes da partida n√£o encontradas! Volte para a tela da temporada.");
        window.location.href = 'temporada.html';
        return;
    }

    // Define os times da partida
    userIsHome = currentMatchInfo.homeTeam === userData.teamName;
    const opponentTeamName = userIsHome ? currentMatchInfo.awayTeam : currentMatchInfo.homeTeam;
    opponent = varzeaUniverse.find(t => t.name === opponentTeamName);
    
    const userTeamObject = { name: userData.teamName, squad: hired };
    homeTeam = userIsHome ? userTeamObject : opponent;
    awayTeam = userIsHome ? opponent : userTeamObject;

    // Popula a interface
    populateTeamColumn('left', homeTeam, homeTeam.name === userData.teamName);
    populateTeamColumn('right', awayTeam, awayTeam.name === userData.teamName);
    elements.headerTitle.textContent = `${currentMatchInfo.competition}`;
    elements.homeTeamName.textContent = homeTeam.name.substring(0, 10);
    elements.awayTeamName.textContent = awayTeam.name.substring(0, 10);
    
    // Inicia a l√≥gica do jogo (novo ou resumido)
    const savedMatch = localStorage.getItem('matchInProgress');
    if (savedMatch) {
        // (L√≥gica de resumir o jogo, como j√° t√≠nhamos)
    } else {
        if (Object.keys(lineup).length < 11) { alert("Nenhuma escala√ß√£o encontrada!"); window.location.href = 'escalacao.html'; return; }
        calculateMatchRevenue();
        halftimeStoppage = Math.floor(Math.random() * 4) + 1;
        fulltimeStoppage = Math.floor(Math.random() * 5) + 1;
        addComentario('0', `‚è±Ô∏è Apita o √°rbitro! Come√ßa a partida pelo ${currentMatchInfo.competition}!`, 'evento');
        resumeGame();
    }
}

// Chutando as fun√ß√µes completas para o final para facilitar a leitura
function saveMatchState() { const state = { score: elements.scoreDisplay.textContent, minute: minuto, half: currentHalf, subsMade: subsMade, subWindows: subWindows, commentary: elements.comentarios.innerHTML, playerEvents: {}, stoppageTimes: { half1: halftimeStoppage, half2: fulltimeStoppage }, revenueDetails: { location: elements.matchLocation.textContent, championship: elements.matchChampionship.textContent, audience: elements.matchAudience.textContent, ticket: elements.matchTicketRevenue.textContent }, matchRevenue: matchRevenue, opponent: opponent }; document.querySelectorAll('li[data-player-id]').forEach(li => { const eventSpan = li.querySelector('.player-events'); if (eventSpan.textContent) { state.playerEvents[li.dataset.playerId] = eventSpan.textContent; } }); document.querySelectorAll('li[data-player-name]').forEach(li => { const eventSpan = li.querySelector('.player-events'); if (eventSpan.textContent) { state.playerEvents[li.dataset.playerName] = eventSpan.textContent; } }); localStorage.setItem('matchInProgress', JSON.stringify(state)); }
function calculateMatchRevenue() { elements.matchLocation.textContent = `Campo do ${homeTeam.name}`; elements.matchChampionship.textContent = currentMatchInfo.competition; const history = JSON.parse(localStorage.getItem('teamHistory')) || { wins: 0, losses: 0 }; const titularesIds = Object.values(lineup); const titulares = hired.filter(j => titularesIds.includes(j.id)); if (titulares.length === 0) return; const averageSkill = titulares.reduce((sum, p) => sum + p.skill, 0) / titulares.length; const baseAudience = (averageSkill / 100) * 700; const historyBonus = (history.wins - history.losses) * 15; const randomFactor = Math.floor(Math.random() * 100) - 50; const totalAudience = Math.round(baseAudience + historyBonus + randomFactor); const finalAudience = Math.max(50, Math.min(totalAudience, 1000)); const ticketRevenue = finalAudience * 5; matchRevenue = ticketRevenue; elements.matchAudience.textContent = `${finalAudience.toLocaleString('pt-BR')} pessoas`; elements.matchTicketRevenue.textContent = formatReal(ticketRevenue); elements.matchTotalRevenue.textContent = formatReal(matchRevenue); }
function gameTick() { const endMin = (currentHalf === 1) ? 45 : 90; const stoppageTime = endMin + (currentHalf === 1 ? halftimeStoppage : fulltimeStoppage); if (minuto > stoppageTime) { pauseGame(); if (currentHalf === 1) { openSubstitutionModal(false); } else { endGame(); } return; } let lance = ""; let tipoLance = 'normal'; const randomEvent = Math.random(); if (randomEvent < 0.04) { let golsCasa = parseInt(elements.scoreDisplay.textContent.split('x')[0]); let golsVisitante = parseInt(elements.scoreDisplay.textContent.split('x')[1]); if (Math.random() < 0.5) { golsCasa++; const scorer = pickPlayerForEvent(['Atacante', 'Meia'], userIsHome ? 'user' : 'opponent'); const teamName = userIsHome ? userData.teamName : opponent.name; lance = `‚öΩ GOOOOL DE ${teamName.toUpperCase()}! Marcado por ${scorer.name}!`; addEventIcon(scorer.id || scorer.name, '‚öΩ', userIsHome ? 'user' : 'opponent'); } else { golsVisitante++; const scorer = pickPlayerForEvent(['Atacante', 'Meia'], userIsHome ? 'opponent' : 'user'); const teamName = userIsHome ? opponent.name : userData.teamName; lance = `‚öΩ GOOOOL DE ${teamName.toUpperCase()}! Marcado por ${scorer.name}!`; addEventIcon(scorer.id || scorer.name, '‚öΩ', userIsHome ? 'opponent' : 'user'); } elements.scoreDisplay.textContent = `${golsCasa} x ${golsVisitante}`; tipoLance = 'gol'; } else if (randomEvent < 0.07) { if (Math.random() < 0.5) { const player = pickPlayerForEvent(['Zagueiro', 'Volante', 'Lateral'], userIsHome ? 'user' : 'opponent'); const teamName = userIsHome ? userData.teamName : opponent.name; lance = `üü® Cart√£o amarelo para ${player.name} de ${teamName}.`; addEventIcon(player.id || player.name, 'üü®', userIsHome ? 'user' : 'opponent'); } else { const player = pickPlayerForEvent(['Zagueiro', 'Volante', 'Lateral'], userIsHome ? 'opponent' : 'user'); const teamName = userIsHome ? opponent.name : userData.teamName; lance = `üü® Cart√£o amarelo para ${player.name} de ${teamName}.`; addEventIcon(player.id || player.name, 'üü®', userIsHome ? 'opponent' : 'user'); } tipoLance = 'cartao'; } else { const lances = [ "Jogada de perigo!", "Falta no meio-campo", "Escanteio", "Contra-ataque perigoso!" ]; lance = lances[Math.floor(Math.random() * lances.length)]; } addComentario(minuto, lance, tipoLance); minuto += Math.floor(Math.random() * 3) + 1; saveMatchState(); }
function endGame() { addComentario('FIM', '‚è±Ô∏è Apita o √°rbitro! Fim de jogo!', 'evento'); elements.btnContinuar.style.display = 'inline-block'; elements.btnSubstituicao.disabled = true; const playersInMatch = Object.values(lineup); hired.forEach(jogador => { if (playersInMatch.includes(jogador.id)) { let desgaste = 8 + Math.floor(Math.random() * 5); jogador.health = Math.max(0, jogador.health - desgaste); } }); let financas = JSON.parse(localStorage.getItem('financasDoTime')); financas.caixaAtual += matchRevenue; financas.receitaPartidas += matchRevenue; const folhaSalarial = hired.reduce((total, player) => total + player.salarioJogo, 0); financas.caixaAtual -= folhaSalarial; financas.gastosSalarios += folhaSalarial; localStorage.setItem('financasDoTime', JSON.stringify(financas)); const history = JSON.parse(localStorage.getItem('teamHistory')) || { wins: 0, losses: 0, draws: 0 }; const golsCasa = parseInt(elements.scoreDisplay.textContent.split('x')[0]); const golsVisitante = parseInt(elements.scoreDisplay.textContent.split('x')[1]); const userWon = (userIsHome && golsCasa > golsVisitante) || (!userIsHome && golsVisitante > golsCasa); const userLost = (userIsHome && golsVisitante > golsCasa) || (!userIsHome && golsCasa > golsVisitante); if (userWon) history.wins++; else if (userLost) history.losses++; else history.draws++; localStorage.setItem('teamHistory', JSON.stringify(history)); localStorage.setItem('elencoDoTime', JSON.stringify(hired)); localStorage.setItem('lastMatchResult', JSON.stringify({ homeTeam: homeTeam.name, awayTeam: awayTeam.name, homeScore: golsCasa, awayScore: golsVisitante })); generateZapMessages(golsCasa, golsVisitante); localStorage.removeItem('treinoRealizado'); localStorage.removeItem('matchInProgress'); }
function generateZapMessages(golsCasa, golsVisitante){ let zapMessages = JSON.parse(localStorage.getItem('zapMessages')) || []; const agora = new Date(); let resumo = `Resultado Final: ${homeTeam.name} ${golsCasa} x ${golsVisitante} ${awayTeam.name}. `; if ((userIsHome && golsCasa > golsVisitante) || (!userIsHome && golsVisitante > golsCasa)) resumo += "Bela vit√≥ria!"; else if ((userIsHome && golsVisitante > golsCasa) || (!userIsHome && golsCasa > golsVisitante)) resumo += "Resultado amargo..."; else resumo += "Tudo igual no placar."; zapMessages.push({ from: "Jo√£o Tartaruga üê¢", text: resumo, read: false, date: agora }); hired.forEach(p => { if (p.health < 50) { zapMessages.push({ from: p.name, text: `Chefe, o corpo t√° pedindo arrego. T√¥ com a sa√∫de em ${p.health}%.`, read: false, date: agora }); } }); localStorage.setItem('zapMessages', JSON.stringify(zapMessages)); }
function pickPlayerForEvent(positions, teamIdentifier) { const isUserTeam = (userIsHome && teamIdentifier === 'user') || (!userIsHome && teamIdentifier === 'opponent'); if (isUserTeam) { const playersInPosition = hired.filter(p => Object.values(lineup).includes(p.id) && positions.includes(p.pos)); if (playersInPosition.length > 0) return playersInPosition[Math.floor(Math.random() * playersInPosition.length)]; return hired.find(p => Object.values(lineup).includes(p.id)); } else { const opponentStarters = opponent.squad.slice(0, 11); const playersInPosition = opponentStarters.filter(p => positions.includes(p.pos)); if (playersInPosition.length > 0) return playersInPosition[Math.floor(Math.random() * playersInPosition.length)]; return opponentStarters[Math.floor(Math.random() * opponentStarters.length)]; } }
function addEventIcon(playerIdentifier, icon, teamIdentifier) { const isUserTeam = (userIsHome && teamIdentifier === 'user') || (!userIsHome && teamIdentifier === 'opponent'); const selector = isUserTeam ? `li[data-player-id="${playerIdentifier}"]` : `li[data-player-name="${playerIdentifier}"]`; const playerLi = document.querySelector(selector); if (playerLi) { const eventSpan = playerLi.querySelector('.player-events'); eventSpan.textContent = icon; } }
function openSubstitutionModal(isMidGame) { /* ... (c√≥digo do modal) ... */ }
function updateSubstitutionModal() { /* ... (c√≥digo do modal) ... */ }
function handleSubPlayerClick(playerId, isTitular) { /* ... (c√≥digo do modal) ... */ }
function performSubstitution(playerOutId, playerInId) { /* ... (c√≥digo do modal) ... */ }
init();
</script>
</body>
</html>
