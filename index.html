<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>O Rei da Várzea — Protótipo</title>
<style>
  body{font-family:sans-serif;margin:0;padding:0;background:#f2f2f2}
  .screen{display:none;padding:20px}
  .active{display:block}
  table{width:100%;border-collapse:collapse;margin-bottom:10px}
  th,td{border:1px solid #ccc;padding:5px;text-align:center}
  .muted{color:#666;font-size:0.9em}
  button{padding:10px 20px;font-size:16px;margin-top:10px}
  .player-name{cursor:pointer;color:blue;text-decoration:underline}
</style>
</head>
<body>

<!-- Tela 1 -->
<div id="screen1" class="screen active">
  <h2>Bem-vindo ao O Rei da Várzea</h2>
  <button id="btnStart">Começar</button>
</div>

<!-- Tela 2: Mercado -->
<div id="screen2" class="screen">
  <h2 id="marketMessage">Escolha seus jogadores</h2>
  <table>
    <thead>
      <tr>
        <th>Nome</th>
        <th>Posição</th>
        <th>Profissão</th>
        <th>Idade</th>
        <th>Salário</th>
        <th>Saúde</th>
        <th>Contratar</th>
      </tr>
    </thead>
    <tbody id="playersTbody"></tbody>
  </table>
  <button id="btnNextStep">Próximo</button>
</div>

<!-- Tela 3 -->
<div id="screen3" class="screen">
  <h2>Resumo do Time</h2>
  <ul id="summary"></ul>
  <button id="btnNextScreen3">Continuar</button>
</div>

<!-- Tela 4 -->
<div id="screen4" class="screen">
  <h2>Time Escalado!</h2>
  <ul id="finalTeam"></ul>
</div>

<script>
const screen1 = document.getElementById('screen1');
const screen2 = document.getElementById('screen2');
const screen3 = document.getElementById('screen3');
const screen4 = document.getElementById('screen4');

const btnStart = document.getElementById('btnStart');
const btnNextStep = document.getElementById('btnNextStep');
const btnNextScreen3 = document.getElementById('btnNextScreen3');

const playersTbody = document.getElementById('playersTbody');
const marketMessage = document.getElementById('marketMessage');
const summary = document.getElementById('summary');
const finalTeam = document.getElementById('finalTeam');

const players = [
  {id:1,name:'João',pos:'Goleiro',profession:{name:'Profissional'},age:22,salary:5000,health:'Ótima',specialityText:'Defesa'},
  {id:2,name:'Carlos',pos:'Goleiro',profession:{name:'Amador'},age:28,salary:3000,health:'Boa',specialityText:'Reflexos'},
  {id:3,name:'Lucas',pos:'Zagueiro',profession:{name:'Profissional'},age:25,salary:4000,health:'Ótima',specialityText:'Desarme'},
  {id:4,name:'Pedro',pos:'Zagueiro',profession:{name:'Amador'},age:27,salary:2500,health:'Boa',specialityText:'Posicionamento'},
  {id:5,name:'Mateus',pos:'Atacante',profession:{name:'Profissional'},age:24,salary:6000,health:'Ótima',specialityText:'Finalização'},
  {id:6,name:'Rafael',pos:'Meio-campo',profession:{name:'Amador'},age:23,salary:3500,health:'Boa',specialityText:'Distribuição'},
  {id:7,name:'Bruno',pos:'Atacante',profession:{name:'Amador'},age:21,salary:2000,health:'Boa',specialityText:'Velocidade'},
  // Adicione todos os jogadores necessários
];

let hired = [];
let marketStep = 0;
const steps = [
  {filter:'Goleiro',min:1,msg:'Escolha seus goleiros'},
  {filter:'Zagueiro',min:2,msg:'Escolha seus zagueiros'},
  {filter:'Meio-campo',min:2,msg:'Escolha seus meio-campistas'},
  {filter:'Atacante',min:2,msg:'Escolha seus atacantes'}
];

function showScreen(screen){
  [screen1,screen2,screen3,screen4].forEach(s=>s.classList.remove('active'));
  screen.classList.add('active');
}

btnStart.onclick = ()=>showScreen(screen2);

function formatReal(num){return 'R$ '+num.toLocaleString('pt-BR')}

function showNotif(msg){alert(msg)}

function onToggleHire(e){
  const id = parseInt(e.target.dataset.id);
  if(e.target.checked){
    const player = players.find(p=>p.id===id);
    hired.push(player);
  }else{
    hired = hired.filter(h=>h.id!==id);
  }
}

function renderMarket(filter){
  playersTbody.innerHTML = '';
  const list = players.filter(p => !hired.some(h => h.id === p.id) && (!filter || p.pos === filter));
  
  if(list.length === 0){
    const tr = document.createElement('tr');
    tr.innerHTML = '<td colspan="7" class="muted">Nenhum jogador disponível para essa posição.</td>';
    playersTbody.appendChild(tr);
    return;
  }

  list.forEach(p=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>
        <strong class="player-name" data-id="${p.id}" onclick="showPlayerPresentation(event, '${p.specialityText.replace(/'/g, "\\'")}')">${p.name}</strong>
        <div class="muted">${p.pos}</div>
      </td>
      <td>${p.pos}</td>
      <td>${p.profession.name}</td>
      <td>${p.age}</td>
      <td>${formatReal(p.salary)}</td>
      <td>${p.health}</td>
      <td style="width:120px">
        <input type="checkbox" data-id="${p.id}" ${hired.some(h => h.id === p.id) ? 'checked' : ''}>
      </td>
    `;
    playersTbody.appendChild(tr);
  });

  playersTbody.querySelectorAll('input[type=checkbox]').forEach(cb => cb.onchange = onToggleHire);
}

function showPlayerPresentation(e,text){alert('Especialidade: '+text)}

btnNextStep.onclick = ()=>{
  const current = steps[marketStep];
  if(current && current.filter){
    const have = hired.filter(h => h.pos === current.filter).length;
    if(have < current.min){
      showNotif(`Escolha no mínimo ${current.min} ${current.filter}(s).`);
      return;
    }
  }

  marketStep++;
  if(marketStep >= steps.length){
    marketStep = steps.length - 1;
    // Avança para Tela 3
    showScreen(screen3);
    renderSummary();
    return;
  }

  marketMessage.textContent = steps[marketStep].msg;
  renderMarket(steps[marketStep].filter);
};

function renderSummary(){
  summary.innerHTML='';
  hired.forEach(p=>{
    const li = document.createElement('li');
    li.textContent = `${p.name} - ${p.pos}`;
    summary.appendChild(li);
  });
}

btnNextScreen3.onclick = ()=>{
  showScreen(screen4);
  renderFinal();
};

function renderFinal(){
  finalTeam.innerHTML='';
  hired.forEach(p=>{
    const li = document.createElement('li');
    li.textContent = `${p.name} - ${p.pos}`;
    finalTeam.appendChild(li);
  });
}

// Inicializa mercado com primeira posição
renderMarket(steps[marketStep].filter);
</script>

</body>
</html>
